From c6b12bb325b1215be0258bd5f0e0814741886148 Mon Sep 17 00:00:00 2001
From: Nikita Travkin <nikita@trvn.ru>
Date: Sat, 14 Jan 2023 20:42:39 +0500
Subject: [PATCH] netdevices: Add msm89xx specific wwan modules

https://github.com/immortalwrt/immortalwrt/commit/c6b12bb325b1215be0258bd5f0e0814741886148.patch

---
 package/kernel/linux/modules/netdevices.mk | 31 ++++++++++++++++++++++
 1 file changed, 31 insertions(+)

diff --git a/package/kernel/linux/modules/netdevices.mk b/package/kernel/linux/modules/netdevices.mk
index 6aebb60d593..bd4aae9472a 100644
--- a/package/kernel/linux/modules/netdevices.mk
+++ b/package/kernel/linux/modules/netdevices.mk
@@ -1569,6 +1569,37 @@ endef
 
 $(eval $(call KernelPackage,mhi-wwan-mbim))
 
+define KernelPackage/rpmsg-wwan-ctrl
+  SUBMENU:=$(NETWORK_DEVICES_MENU)
+  TITLE:=RPMSG WWAN Control
+  DEPENDS:=@LINUX_6_1 +kmod-wwan
+  KCONFIG:=CONFIG_RPMSG_WWAN_CTRL
+  FILES:=$(LINUX_DIR)/drivers/net/wwan/rpmsg_wwan_ctrl.ko
+  AUTOLOAD:=$(call AutoProbe,rpmsg_wwan_ctrl)
+endef
+
+define KernelPackage/rpmsg-wwan-ctrl/description
+ Driver for RPMSG WWAN Control
+ This exposes all modem control ports like AT, QMI that use RPMSG
+endef
+
+$(eval $(call KernelPackage,rpmsg-wwan-ctrl))
+
+define KernelPackage/bam-dmux
+  SUBMENU:=$(NETWORK_DEVICES_MENU)
+  TITLE:=Qualcomm BAM-DMUX WWAN network driver
+  DEPENDS:=@TARGET_msm89xx +kmod-wwan
+  KCONFIG:=CONFIG_QCOM_BAM_DMUX
+  FILES:=$(LINUX_DIR)/drivers/net/wwan/qcom_bam_dmux.ko
+  AUTOLOAD:=$(call AutoProbe,qcom_bam_dmux)
+endef
+
+define KernelPackage/bam-dmux/description
+  Kernel modules for Qualcomm BAM-DMUX WWAN interface
+endef
+
+$(eval $(call KernelPackage,bam-dmux))
+
 define KernelPackage/atlantic
   SUBMENU:=$(NETWORK_DEVICES_MENU)
   TITLE:=Aquantia AQtion 10Gbps Ethernet NIC
