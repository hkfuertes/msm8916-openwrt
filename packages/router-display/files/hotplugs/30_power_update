#!/bin/sh
# /etc/hotplug.d/button/30_power_update

# Only process power button events
[ "$BUTTON" = "power" ] || exit 0

# Check if system is shutting down
if pgrep poweroff >/dev/null 2>&1 || \
   pgrep halt >/dev/null 2>&1 || \
   pgrep reboot >/dev/null 2>&1; then
    logger -t display "System shutting down - skipping"
    exit 0
fi

# Execute update-display on button release
[ "${ACTION}" = "released" ] && /usr/sbin/update-display

exit 0
